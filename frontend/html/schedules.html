<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Schedules - Gym Management</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/schedules.css">
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>
<body>

  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo">Gym Management System</div>
    <nav>
        <a href="dashboard.html" class="nav-item-admin"><i class="ph ph-house"></i> Dashboard</a>
        <a href="members.html" class="nav-item-admin"><i class="ph ph-users"></i> Members</a>
        <a href="coaches.html" class="nav-item-all"><i class="ph ph-user"></i> Coaches</a>
        <a href="payments.html" class="nav-item-admin"><i class="ph ph-coins"></i> Payment History</a>
        <a href="schedules.html" class="nav-item-all"><i class="ph ph-calendar"></i> Schedules</a>
    </nav>
  </aside>

  <!-- Main Content Area -->
  <div class="main">

    <!-- Header -->
    <header class="topbar">
      <button id="toggleSidebar" class="menu-btn">â˜°</button>
      <h1>Schedules</h1>
      <div class="user-menu">
        <div class="user-profile-dropdown">
          <button class="user-profile-btn" id="userProfileBtn" onclick="toggleUserDropdown()">
            <div class="user-avatar" id="userAvatar">U</div>
            <span id="userName">User</span>
            <i class="ph ph-caret-down"></i>
          </button>
          <div class="user-dropdown-menu" id="userDropdownMenu">
            <div class="user-dropdown-header">
              <div class="user-dropdown-avatar" id="userDropdownAvatar">U</div>
              <div class="user-dropdown-info">
                <div class="user-dropdown-name" id="userDropdownName">User</div>
                <div class="user-dropdown-email" id="userDropdownEmail">user@example.com</div>
                <div class="user-dropdown-role" id="userDropdownRole"></div>
              </div>
            </div>
            <div class="user-dropdown-divider"></div>
            <a href="profile.html" class="user-dropdown-item">
              <i class="ph ph-user-circle"></i>
              <span>My Profile</span>
            </a>
            <button class="user-dropdown-item" onclick="logout()">
              <i class="ph ph-sign-out"></i>
              <span>Log out</span>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Schedules Content -->
    <section class="content schedules-container">
      
      <!-- Header with Actions -->
      <div class="schedules-header">
        <h2>Class Schedules</h2>
        <div class="header-actions">
          <div class="view-toggle">
            <button class="view-btn active" data-view="table" onclick="switchView('table')">
              <i class="ph ph-list"></i> Table
            </button>
            <button class="view-btn" data-view="calendar" onclick="switchView('calendar')">
              <i class="ph ph-calendar-blank"></i> Calendar
            </button>
          </div>
          <button class="btn-create-schedule" onclick="openScheduleModal()" style="display: none;">
            <i class="ph ph-plus"></i> Create Schedule
          </button>
        </div>
      </div>

      <!-- Search and Filters -->
      <div class="schedules-filters">
        <div class="filter-group">
          <label><i class="ph ph-magnifying-glass"></i> Search by Class Name</label>
          <input type="text" id="searchClassName" placeholder="Enter class name..." onkeyup="applyFilters()">
        </div>
        <div class="filter-group">
          <label><i class="ph ph-user"></i> Search by Coach</label>
          <select id="searchCoach" onchange="applyFilters()">
            <option value="">All Coaches</option>
          </select>
        </div>
        <div class="filter-group">
          <label><i class="ph ph-calendar"></i> Search by Date</label>
          <input type="date" id="searchDate" onchange="applyFilters()">
        </div>
        <button class="btn-clear-filters" onclick="clearFilters()">
          <i class="ph ph-x"></i> Clear
        </button>
      </div>

      <!-- Table View -->
      <div id="tableView" class="schedules-table-container">
        
        <!-- Current and Upcoming Schedules -->
        <div class="table-section">
          <h3 class="table-section-title">
            <i class="ph ph-calendar-check"></i> Current & Upcoming Schedules
          </h3>
          <table class="schedules-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Class Name</th>
                <th>Coach</th>
                <th>Date</th>
                <th>Time</th>
                <th>Duration</th>
                <th>Capacity</th>
                <th>Status</th>
                <th class="admin-only">Actions</th>
              </tr>
            </thead>
            <tbody id="currentSchedulesTableBody">
              <tr>
                <td colspan="9" style="text-align: center; padding: 40px;">
                  <i class="ph ph-calendar-x" style="font-size: 48px; color: #ccc;"></i>
                  <p style="color: #999; margin-top: 10px;">No current or upcoming schedules found.</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Completed Schedules -->
        <div class="table-section">
          <h3 class="table-section-title">
            <i class="ph ph-check-circle"></i> Completed Schedules
          </h3>
          <table class="schedules-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Class Name</th>
                <th>Coach</th>
                <th>Date</th>
                <th>Time</th>
                <th>Duration</th>
                <th>Capacity</th>
                <th>Status</th>
                <th class="admin-only">Actions</th>
              </tr>
            </thead>
            <tbody id="completedSchedulesTableBody">
              <tr>
                <td colspan="9" style="text-align: center; padding: 40px;">
                  <i class="ph ph-calendar-x" style="font-size: 48px; color: #ccc;"></i>
                  <p style="color: #999; margin-top: 10px;">No completed schedules found.</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

      </div>

      <!-- Calendar View -->
      <div id="calendarView" class="calendar-container" style="display: none;">
        <div class="calendar-header">
          <div class="calendar-nav">
            <button onclick="previousMonth()"><i class="ph ph-caret-left"></i></button>
            <h3 id="calendarMonthYear">November 2024</h3>
            <button onclick="nextMonth()"><i class="ph ph-caret-right"></i></button>
          </div>
          <button class="btn-secondary" onclick="goToToday()">Today</button>
        </div>
        <div class="calendar-grid" id="calendarGrid">
          <!-- Calendar will be generated by JavaScript -->
        </div>
      </div>

    </section>

  </div>

  <!-- Create/Edit Schedule Modal -->
  <div id="scheduleModal" class="schedule-modal">
    <div class="schedule-modal-content">
      <div class="schedule-modal-header">
        <h2 id="scheduleModalTitle">Create New Schedule</h2>
        <button class="close-schedule-modal" onclick="closeScheduleModal()">&times;</button>
      </div>
      <form id="scheduleForm">
        <div class="schedule-modal-body">
          <div class="form-group">
            <label for="className">Class Name *</label>
            <input type="text" id="className" required placeholder="e.g., Yoga, CrossFit, Boxing">
          </div>

          <div class="form-group">
            <label for="coachId">Coach *</label>
            <select id="coachId" required>
              <option value="">Select Coach</option>
            </select>
          </div>

          <div class="form-group">
            <label for="scheduleDate">Date *</label>
            <input type="date" id="scheduleDate" required>
          </div>

          <div class="form-group">
            <label for="startTime">Start Time *</label>
            <input type="time" id="startTime" required>
          </div>

          <div class="form-group">
            <label for="endTime">End Time *</label>
            <input type="time" id="endTime" required>
          </div>

          <div class="form-group">
            <label for="capacity">Capacity (Max Participants)</label>
            <input type="number" id="capacity" min="1" placeholder="e.g., 20">
          </div>

          <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" rows="3" placeholder="Class description..."></textarea>
          </div>
        </div>

        <div class="schedule-modal-actions">
          <button type="button" class="btn-secondary" onclick="closeScheduleModal()">Cancel</button>
          <button type="submit" class="btn-primary">
            <span id="scheduleSubmitText">Create Schedule</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Day View Modal -->
  <div id="dayViewModal" class="day-view-modal">
    <div class="day-view-content">
      <div class="day-view-header">
        <button class="day-nav-btn" onclick="navigateDay(-1)" title="Previous Day">
          <i class="ph ph-caret-left"></i>
        </button>
        <h2 id="dayViewDate">Day Schedule</h2>
        <button class="day-nav-btn" onclick="navigateDay(1)" title="Next Day">
          <i class="ph ph-caret-right"></i>
        </button>
        <button class="close-day-view" onclick="closeDayView()">&times;</button>
      </div>
      <div class="day-view-body" id="dayViewTimeline">
        <!-- Timeline will be generated by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Coach Profile Modal -->
  <div id="coachProfileModal" class="coach-profile-modal">
    <div class="coach-profile-content">
      <div class="coach-profile-header" style="position: relative;">
        <button class="close-profile" onclick="closeCoachProfile()">&times;</button>
        <img id="coachPhoto" src="https://via.placeholder.com/100" alt="Coach Photo" class="coach-profile-photo">
        <div class="coach-profile-info">
          <h2 id="coachName">Coach Name</h2>
          <p id="coachSpecialty"><i class="ph ph-star"></i> Specialty</p>
          <p id="coachExperience"><i class="ph ph-briefcase"></i> Experience</p>
        </div>
      </div>
      <div class="coach-profile-body">
        <div class="profile-section">
          <h3>Bio</h3>
          <p id="coachBio">Coach biography will appear here...</p>
        </div>
        <div class="profile-section">
          <h3>Skills & Expertise</h3>
          <div class="skills-list" id="coachSkills">
            <!-- Skills will be populated here -->
          </div>
        </div>
        <div class="profile-section">
          <h3>Upcoming Classes</h3>
          <ul class="schedule-list" id="coachSchedules">
            <!-- Schedules will be populated here -->
          </ul>
        </div>
        <div class="profile-section">
          <h3>Availability</h3>
          <div class="availability-grid" id="coachAvailability">
            <!-- Availability will be populated here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Schedule Detail Modal -->
  <div id="scheduleDetailModal" class="schedule-detail-modal">
    <div class="schedule-detail-content">
      <div class="schedule-detail-header">
        <h2 id="scheduleDetailTitle">Class Details</h2>
        <button class="close-schedule-detail" onclick="closeScheduleDetailModal()">&times;</button>
      </div>
      <div class="schedule-detail-body">
        <div class="detail-section">
          <div class="detail-status-badge" id="detailStatusBadge">
            <span id="detailStatus">Status</span>
          </div>
        </div>
        
        <div class="detail-section">
          <h3><i class="ph ph-calendar"></i> Schedule Information</h3>
          <div class="detail-grid">
            <div class="detail-item">
              <label>Date</label>
              <p id="detailDate">-</p>
            </div>
            <div class="detail-item">
              <label>Time</label>
              <p id="detailTime">-</p>
            </div>
            <div class="detail-item">
              <label>Duration</label>
              <p id="detailDuration">-</p>
            </div>
          </div>
        </div>

        <div class="detail-section">
          <h3><i class="ph ph-user"></i> Coach</h3>
          <div class="detail-coach-card" id="detailCoachCard">
            <img id="detailCoachPhoto" src="" alt="Coach Photo" class="detail-coach-photo">
            <div class="detail-coach-info">
              <h4 id="detailCoachName">Coach Name</h4>
              <p id="detailCoachSpecialty">Specialty</p>
            </div>
            <button class="btn-view-coach" id="detailViewCoachBtn">View Profile</button>
          </div>
        </div>

        <div class="detail-section">
          <h3><i class="ph ph-users"></i> Capacity</h3>
          <div class="detail-capacity">
            <div class="capacity-bar">
              <div class="capacity-fill" id="detailCapacityFill"></div>
            </div>
            <p id="detailCapacityText">0 / 0 enrolled</p>
          </div>
        </div>

        <div class="detail-section" id="detailDescriptionSection">
          <h3><i class="ph ph-note"></i> Description</h3>
          <p id="detailDescription">No description provided.</p>
        </div>

        <div class="detail-actions" id="detailActions">
          <!-- Action buttons will be populated here -->
        </div>
      </div>
    </div>
  </div>

  <script src="/js/auth-check.js"></script>
  <script src="/js/script.js"></script>
  <script src="/js/schedules.js"></script>
</body>
</html>
